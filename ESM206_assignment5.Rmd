---
title: "Trends in Graduate Enrollment, Shifting Fields of Study, and Faculty Salary"
author: "Sam Csik"
date: "11/28/2018"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load packages & data}

library(tidyverse)
library(stargazer)

enrollment <- read_csv("grad_enrollment_copy.csv")
```


```{r male vs. female grad enrollment (1967-2015)}

# SOURCE: U.S. Department of Education, National Center for Education Statistics, Higher Education General Information Survey (HEGIS), “Fall Enrollment in Colleges and Universities” surveys, 1967 through 1985; Integrated Postsecondary Education Data System (IPEDS),“Fall Enrollment Survey” (IPEDS-EF:86-99); IPEDS Spring 2001 through Spring 2016, Fall Enrollment component. Accessed at: https:// nces.ed.gov/ programs/digest/ d16/ tables/ dt16_303.80.asp.

##############################
# subset total males and females
##############################

total_males <- enrollment %>% 
  select(year, total_males) %>% 
  mutate(total = total_males) # add column called "total" that is equal to the "total_males" column so that we can plot males and females on same plot with same y-axis

total_females <- enrollment %>% 
  select(year, total_females) %>% 
  mutate(total = total_females) # add column called "total" that is equal to the "total_females" column so that we can plot males and females on same plot with same y-axis

##############################
# plot trends through time
##############################

total_enroll_plot <- ggplot(total_males, aes(x = year, y = total)) +
  geom_point(color = "gray30") +
  geom_line(color = "gray30") +
  geom_point(data = total_females, color = "gray30") +
  geom_line(data = total_females, color = "gray30", linetype = "dotted") +
  theme_classic() +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 0.7)) +
  labs(x = "Year", y = "Total Male & Female Graduate Student \nEnrollment in the U.S.") +
  scale_y_continuous(labels = scales::scientific)

# Figure 1. Male and female graduate enrollment in the U.S. (1967-2015). Male (solid line) and female (dotted line) graduate students...

##############################
# net & percent increase in total males
##############################

m_1967 <- total_males %>% # subset 1967 males
  filter(year == 1967)

m_2015 <- total_males %>% # subset 2015 males
  filter(year == 2015)

net_males <- m_2015$total - m_1967$total # net increase from 1967-2015
perc_males <- ((m_2015$total - m_1967$total)/m_1967$total) * 100 # % increase from 1967 - 2015

##############################
# net & percent increase in total females
##############################

f_1967 <- total_females %>% # subset 1967 females
  filter(year == 1967)

f_2015 <- total_females %>% # subset 2015 females 
  filter(year == 2015)

net_females <- f_2015$total - f_1967$total # net increase from 1967-2015
per_females <- ((f_2015$total - f_1967$total)/f_1967$total) * 100 # % increase from 1967 - 2015

##############################
# check data for assumptions of 1-way 2-sample t-test
##############################

males_hist <- ggplot(data = total_males, aes(x = total)) + # males are normally distributed
  geom_histogram()
males_qq <- ggplot(data = total_males, aes(sample = total)) + # may be a little concerning...
  geom_qq()
var.test(m_1967$total, m_2015$total) # NOT WORKING

females_hist <- ggplot(data = total_females, aes(x = total)) + # not super duper normal looking
  geom_histogram(binwidth = 75000)
females_qq <- ggplot(data = total_females, aes(sample = total)) + # generally OK
  geom_qq()
var.test(f_1967$total, f_2015$total) # NOT WORKING

##############################
# conduct 1-way 2-sample t-test for males and females
##############################

t_males <- t.test(m_2015$total, m_1967$total, alternative = "greater") # SAME ERROR AS VAR.TEST
f_males <- t.test(f_2015$total, f_1967$total, alternative = "greater") # SAME ERROR AS VAR.TEST

```

##### Shifts in female PhD recipients by field (1985, 2000, and 2015). 
Describe if and how there was a shift in PhDs awarded to females in four fields (Physical and Earth Sciences, Engineering, Education, and Humanities & Arts) in 1985, 2000, and 2015. Describe your results statistically, in a graph or table, and in text. Note: There are several ways that you can interpret this question. You are invited to decide which you think is/are most interesting. Just be really clear about what you are asking/answering in your report.

